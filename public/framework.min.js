var Framework=function(e){"use strict";const t={},n={},o={"x-text":(t,n,o)=>{e.effect(()=>{const e=a(n,o);t.textContent=e})},"x-show":(t,n,o)=>{e.effect(()=>{const e=a(n,o);t.style.display=e?"":"none";const r=t.nextElementSibling;if(r&&r.hasAttribute("x-else")){const t=!e;r.style.display=t?"":"none"}})},"x-model":(t,n,o)=>{const r=t;e.effect(()=>{const e=a(n,o);!function(e,t){if(e instanceof HTMLInputElement){if("checkbox"===e.type)return void(e.checked=Boolean(t));if("radio"===e.type)return void(e.checked=e.value===String(t))}e.value=String(t??"")}(r,e)}),r.addEventListener("input",()=>{const e=function(e){return e instanceof HTMLInputElement?"checkbox"===e.type?e.checked:"radio"===e.type?e.checked?e.value:null:"number"===e.type?""===e.value?null:Number(e.value):e.value:e.value}(r);void 0!==o[n]?.value?o[n].value=e:o[n]=e})},"x-form":function(e,t,o){if(!(e instanceof HTMLFormElement))return void console.error("x-form directive can only be used on form elements.");const r=e,i=t,c=n[i];if(!c)return void console.error(`Form validation schema not found: "${i}"`);r.addEventListener("input",e=>{s(e.target,c)}),r.addEventListener("submit",e=>{const t=function(e,t){const n=new FormData(e);let o=!0;return n.forEach((e,t)=>{e.toString()}),e.querySelectorAll("input, textarea, select").forEach(e=>{const n=e;s(n,t),n.checkValidity()||(o=!1)}),o}(r,c);if(t){if(c.onSubmit){const t=new FormData(r),n={};t.forEach((e,t)=>{n[t]=e.toString()}),c.onSubmit(e,n)}}else e.preventDefault()})},"x-if":function(t,n,o){if(!(t instanceof HTMLTemplateElement))return void console.error("x-if directive must be used on a <template> element.");u(t,"x-if");const i=function(e){const t=e.nextElementSibling;return t instanceof HTMLTemplateElement&&t.hasAttribute("x-else")?t:null}(t);i&&u(i,"x-else");let s=null;const c=(e,t)=>{const n=e.content.cloneNode(!0),o=Array.from(n.children);for(const n of o)e.parentElement?.insertBefore(n,e.nextSibling),n instanceof Element&&r(n,t)};e.effect(()=>{const e=a(n,o);s!==e&&(s=e,e?(d(i,"x-else"),f(t,"x-if")||c(t,o)):(d(t,"x-if"),i&&!f(i,"x-else")&&c(i,o)))})},"x-for":function(t,n,o){if(!(t instanceof HTMLTemplateElement))return void console.error("x-for directive must be used on a <template> element.");const i=t,s=i.parentNode,[c,l,u]=function(e){const t=e.match(/^\((\w+),\s*(\w+)\)\s+in\s+(.+)$/);if(t)return[t[1],t[2],t[3].trim()];const n=e.match(/^(\w+)\s+in\s+(.+)$/);if(!n)throw new Error(`Invalid x-for expression: "${e}"`);return[n[1],null,n[2].trim()]}(n),f=i.getAttribute(":key")||i.getAttribute("x-key"),d=document.createComment(` x-for: ${n} `);s.insertBefore(d,i);let p=new Map;const y=e=>{const t=i.content.cloneNode(!0),n=Array.from(t.childNodes);for(const t of n)t instanceof Element&&r(t,e);return n};e.effect(()=>{const e=a(u,o),t=p,n=new Map,r=[];if(Array.isArray(e))for(let i=0;i<e.length;i++){const s=e[i],a=b(o,c,l,s,i),u=m(f,a,i),d=t.get(u);if(d)Object.assign(d.scope,a),r.push(...d.nodes),n.set(u,d),t.delete(u);else{const e=y(a);r.push(...e),n.set(u,{nodes:e,scope:a})}}for(const{nodes:e}of t.values())e.forEach(e=>{e.parentNode===s&&s.removeChild(e)});let h=d;for(const e of r)h.nextSibling!==e&&s.insertBefore(e,h.nextSibling),h=e;let g=h.nextSibling;for(;g&&g!==i;){const e=g.nextSibling;g.parentNode===s&&s.removeChild(g),g=e}p=n})},"x-load":(e,t,n)=>{e.style.display="block"}};function r(n=document.body,r={}){!function(e,t={},n){function o(e,t){if("TEMPLATE"===e.tagName&&e.id)return;const r=n(e,t),i=Array.from(e.children);for(const e of i)o(e,r)}o(e,t)}(n,r,(n,r)=>{let s={...r};s=function(e,n){const o=e.getAttribute("x-data");if(!o)return n;if(t[o])e._data=t[o]();else try{const t=i(a(o,{}));e._data=t}catch(e){return console.error(`Failed to evaluate x-data "${o}" as inline object`,e),n}return{...n,...e._data}}(n,s);const c=function(e,n){if(!e.tagName.includes("-"))return n;const o=e.tagName.toLowerCase();if(!t[o]||e._data)return n;const r=function(e,t){const n=e.getAttribute("x-props");if(!n)return{};try{return a(n,t)}catch(e){return console.error("Error parsing props:",e),{}}}(e,n),i=p(e);return e._data=t[o](r,{emit:i}),{...n,...e._data}}(n,s);return c!==s&&(s=c),function(t,n){Object.keys(o).forEach(e=>{if(t.hasAttribute(e)){const r=t.getAttribute(e);(r||"x-load"===e)&&o[e](t,r||"",n)}});Array.from(t.attributes).filter(e=>e.name.startsWith("@")||e.name.startsWith(":")).forEach(o=>{const r=o.value;if(r)if(o.name.startsWith("@")){const e=o.name.substring(1);!function(e,t,n,o){const r=e=>e?._data?p(e):e.parentElement?r(e.parentElement):null,i=r(e);e.addEventListener(t,e=>{const t={...o,$event:e,emit:i};a(n,t)})}(t,e,r,n)}else if(o.name.startsWith(":")){const i=o.name.substring(1);!function(t,n,o,r){e.effect(()=>{const e=a(o,r);if("class"===n){if("string"==typeof e)t.className=e;else if(Array.isArray(e))t.className=e.join(" ");else if("object"==typeof e){const n=Object.entries(e).filter(([e,t])=>t).map(([e])=>e).join(" ");t.className=n}}else"style"===n?"string"==typeof e?t.style.cssText=e:"object"==typeof e&&Object.entries(e).forEach(([e,n])=>{t.style.setProperty(e,String(n))}):!1===e||null==e?t.removeAttribute(n):t.setAttribute(n,String(e))})}(t,i,r,n)}})}(n,s),s})}function i(t){if("object"!=typeof t||null===t)return t;const n={};return Object.keys(t).forEach(o=>{const r=t[o];"function"==typeof r?n[o]=r.bind(n):"object"!=typeof r||null===r||Array.isArray(r)?n[o]=e.signal(r):n[o]=i(r)}),n}function s(e,t){const n=e.name;if(!n)return;const{fields:o}=t;if(!o||!o[n]){e.setCustomValidity("");const t=e.getAttribute("aria-describedby");if(t){const e=document.getElementById(t);e&&(e.textContent="")}return}const r=o[n].safeParse(e.value),i=e.getAttribute("aria-describedby");let s=null;if(i&&(s=document.getElementById(i)),r.success)e.setCustomValidity("");else{const t=r.error.issues[0]?.message||"Invalid value";e.setCustomValidity(t)}s&&(s.textContent=e.validationMessage)}const c={data:function(e,n){t[e]=n},component:function(e,n){t[e]=n;const o=document.getElementById(e);o&&function(e,t){class n extends l{constructor(){super(t)}}customElements.define(e,n)}(e,o)},render:async function(e,n){document.dispatchEvent(new CustomEvent("framework:init")),await async function(e){const t=e.filter(e=>e.includes("-"));if(t.length>0){const e=t.map(e=>customElements.whenDefined(e).catch(()=>null));await Promise.all(e)}}(Object.keys(t)),r(e,n)},form:function(e,t,o){n[e]={fields:t,onSubmit:o}},signal:e.signal,effect:e.effect};function a(e,t){try{return new Function("data",`with(data) { return ${e} }`)(t)}catch(t){return console.error(`Error evaluating expression: "${e}"`,t),null}}"undefined"!=typeof window&&(window.Framework=c);class l extends HTMLElement{constructor(e){super(),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e}connectedCallback(){const e=this.template.content.cloneNode(!0);this.appendChild(e)}disconnectedCallback(){this._data.onUnmounted&&this._data.onUnmounted()}}function u(e,t){const n=e.nextSibling;if(n instanceof Comment&&n.nodeValue===t)return n;const o=document.createComment(t);return e.parentNode?.insertBefore(o,e.nextSibling),o}function f(e,t){const n=e.nextSibling;return!(n instanceof Comment&&n.nodeValue===t)&&null!==n}function d(e,t){if(!e)return;let n=e.nextSibling;for(;n&&!(n instanceof Comment&&n.nodeValue===t);){const e=n.nextSibling;n.parentNode?.removeChild(n),n=e}}function m(e,t,n){return String(e?a(e,t):n)}function b(e,t,n,o,r){const i={...e,[t]:o,$index:r};return n&&(i[n]=r,i.index=r),i}function p(e){return(t,n)=>{e.dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0}))}}return c}(signalsCore);
